# Build Guide - MERN Stack Hospital Management System

This guide explains the build process and environment configuration for the hospital management system.

## ğŸ—ï¸ Build Commands

### Root Package.json Scripts

```bash
# Build all services
npm run build

# Build individual services
npm run build:backend    # Backend API
npm run build:frontend   # Frontend (patient interface)
npm run build:dashboard  # Dashboard (admin interface)

# Development commands
npm run dev              # Run all services concurrently
npm run dev:backend      # Run backend only
npm run dev:frontend     # Run frontend only
npm run dev:dashboard    # Run dashboard only

# Install all dependencies
npm run install:all
```

## ğŸ”§ Environment Configuration

### Frontend Environment Variables
Create `frontend/.env`:
```bash
VITE_API_URL=http://localhost:4000
```

### Dashboard Environment Variables
Create `dashboard/.env`:
```bash
VITE_API_URL=http://localhost:4000
```

### Backend Environment Variables
Create `backend/.env`:
```bash
PORT=4000
NODE_ENV=development
MONGODB_URI=mongodb://localhost:27017/hospital-management
JWT_SECRET=your-secret-key
JWT_EXPIRE=7d
COOKIE_EXPIRE=7
FRONTEND_URL=http://localhost:5173
DASHBOARD_URL=http://localhost:5174
```

## ğŸš€ Render Deployment Configuration

The `render.yaml` file is configured to:

1. **Build all services** using the root package.json scripts
2. **Use environment variables** for API URLs
3. **Enable PR Previews** and Auto-Deploy
4. **Configure health checks** for the backend

### Render Environment Variables

#### Backend Service
```yaml
NODE_ENV: production
MONGODB_URI: # Auto-configured from database
JWT_SECRET: # Auto-generated by Render
JWT_EXPIRE: 7d
COOKIE_EXPIRE: 7
CORS_ORIGIN: https://hospital-frontend.onrender.com
```

#### Frontend Service
```yaml
VITE_API_URL: https://patient-nexus-backend.onrender.com
```

#### Dashboard Service
```yaml
VITE_API_URL: https://patient-nexus-backend.onrender.com
```

## ğŸ“ Project Structure

```
â”œâ”€â”€ package.json              # Root build configuration
â”œâ”€â”€ render.yaml               # Render deployment config
â”œâ”€â”€ backend/                  # Node.js API server
â”‚   â”œâ”€â”€ server.js            # Server entry point
â”‚   â”œâ”€â”€ app.js               # Express app configuration
â”‚   â”œâ”€â”€ package.json         # Backend dependencies
â”‚   â””â”€â”€ .env                 # Backend environment variables
â”œâ”€â”€ frontend/                # React patient interface
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ utils/api.js     # API configuration
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ package.json         # Frontend dependencies
â”‚   â””â”€â”€ .env                 # Frontend environment variables
â””â”€â”€ dashboard/               # React admin dashboard
    â”œâ”€â”€ src/
    â”‚   â”œâ”€â”€ utils/api.js     # API configuration
    â”‚   â””â”€â”€ ...
    â”œâ”€â”€ package.json         # Dashboard dependencies
    â””â”€â”€ .env                 # Dashboard environment variables
```

## ğŸ”„ API Configuration

### Centralized API Management

Both frontend and dashboard use centralized API configuration:

```javascript
// frontend/src/utils/api.js & dashboard/src/utils/api.js
const API_BASE_URL = import.meta.env.VITE_API_URL || 'http://localhost:4000';

export const API_ENDPOINTS = {
  LOGIN: `${API_BASE_URL}/api/v1/user/login`,
  REGISTER: `${API_BASE_URL}/api/v1/user/patient/register`,
  // ... more endpoints
};
```

### Benefits
- âœ… **No hardcoded URLs** - All URLs use environment variables
- âœ… **Easy deployment** - Change API URL for different environments
- âœ… **Centralized management** - All endpoints in one place
- âœ… **Type safety** - Consistent endpoint usage

## ğŸ› ï¸ Development Setup

### 1. Install Dependencies
```bash
npm run install:all
```

### 2. Set Environment Variables
Create `.env` files in each service directory with the variables listed above.

### 3. Start Development
```bash
# Start all services
npm run dev

# Or start individually
npm run dev:backend
npm run dev:frontend
npm run dev:dashboard
```

## ğŸš€ Production Deployment

### Render Deployment
1. Push code to GitHub
2. Connect repository to Render
3. Render will automatically:
   - Build all services using root package.json scripts
   - Configure environment variables
   - Deploy to production URLs

### Manual Deployment
```bash
# Build all services
npm run build

# Start backend
npm start
```

## ğŸ” Health Checks

The backend includes a health check endpoint:
- **URL**: `/api/v1/health`
- **Method**: GET
- **Response**: JSON with server status and timestamp

## ğŸš¨ Troubleshooting

### Build Issues
1. **Missing dependencies**: Run `npm run install:all`
2. **Environment variables**: Ensure all `.env` files are created
3. **Port conflicts**: Check if ports 4000, 5173, 5174 are available

### API Issues
1. **CORS errors**: Check CORS_ORIGIN in backend environment
2. **Connection refused**: Verify backend is running on correct port
3. **Environment variables**: Ensure VITE_API_URL is set correctly

### Render Issues
1. **Build fails**: Check build logs in Render dashboard
2. **Environment variables**: Verify all required variables are set
3. **Database connection**: Check MongoDB connection string

## ğŸ“ Notes

- All services use **environment variables** for configuration
- **No hardcoded URLs** - everything is configurable
- **Centralized build process** - single command builds all services
- **Development-friendly** - concurrent development servers
- **Production-ready** - optimized for Render deployment

Your hospital management system is now fully configured for both development and production deployment! ğŸ¥âœ¨ 