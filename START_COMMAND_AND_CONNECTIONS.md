# 🚀 Start Commands & Full Connection Guide

## 📋 Start Commands for Render Deployment

### Backend Service Start Command
```bash
cd backend && npm start
```

**What this does:**
- Changes directory to `backend/`
- Runs `npm start` which executes `node server.js`
- Server starts on `process.env.PORT` (auto-assigned by Render)

### Frontend Service Start Command
```bash
# Frontend is a static site, so no start command needed
# Build command: npm run build:frontend
# Static files served from: ./frontend/dist
```

### Dashboard Service Start Command
```bash
# Dashboard is a static site, so no start command needed
# Build command: npm run build:dashboard
# Static files served from: ./dashboard/dist
```

## 🔗 Complete Connection Map

### 1. Backend Connections ✅

#### Database Connection
```javascript
// backend/database/dbConnection.js
mongoose.connect(process.env.MONGODB_URI)
```
- **Environment Variable**: `MONGODB_URI`
- **Render Source**: Auto-configured from database
- **Development**: `mongodb://localhost:27017/hospital-management`

#### Server Configuration
```javascript
// backend/server.js
app.listen(process.env.PORT, () => {
  console.log(`Server listening at port ${process.env.PORT}`);
});
```
- **Environment Variable**: `PORT`
- **Render**: Auto-assigned (e.g., 10000)
- **Development**: 4000

#### CORS Configuration
```javascript
// backend/app.js
app.use(cors({
  origin: [process.env.FRONTEND_URL, process.env.DASHBOARD_URL],
  credentials: true,
}));
```
- **Frontend URL**: `https://hospital-frontend.onrender.com`
- **Dashboard URL**: `https://hospital-dashboard.onrender.com`

### 2. Frontend Connections ✅

#### API Configuration
```javascript
// frontend/src/utils/api.js
const API_BASE_URL = import.meta.env.VITE_API_URL || 'http://localhost:4000';
const DASHBOARD_URL = import.meta.env.VITE_DASHBOARD_URL || 'http://localhost:5174';
```

#### Environment Variables
- **VITE_API_URL**: `https://hospital-backend.onrender.com`
- **VITE_DASHBOARD_URL**: `https://hospital-dashboard.onrender.com`

#### Component Connections
- ✅ **App.jsx**: Uses `API_ENDPOINTS.GET_USER`
- ✅ **Register.jsx**: Uses `API_ENDPOINTS.REGISTER`
- ✅ **Login.jsx**: Uses `API_ENDPOINTS.LOGIN`
- ✅ **Navbar.jsx**: Uses `API_ENDPOINTS.LOGOUT` and `API_ENDPOINTS.DASHBOARD_URL`
- ✅ **MessageForm.jsx**: Uses `API_ENDPOINTS.SEND_MESSAGE`
- ✅ **AppointmentForm.jsx**: Uses `API_ENDPOINTS.GET_DOCTORS` and `API_ENDPOINTS.POST_APPOINTMENT`

### 3. Dashboard Connections ✅

#### API Configuration
```javascript
// dashboard/src/utils/api.js
const API_BASE_URL = import.meta.env.VITE_API_URL || 'http://localhost:4000';
```

#### Environment Variables
- **VITE_API_URL**: `https://hospital-backend.onrender.com`
- **VITE_DASHBOARD_URL**: `https://hospital-dashboard.onrender.com`

#### Component Connections
- ✅ **App.jsx**: Uses `API_BASE_URL` for axios defaults
- ✅ **Sidebar.jsx**: Uses `API_ENDPOINTS.ADMIN_LOGOUT`
- ✅ **Messages.jsx**: Uses `API_ENDPOINTS.GET_MESSAGES`
- ✅ **EditDoctor.jsx**: Uses `API_ENDPOINTS.GET_DOCTOR_BY_ID` and `API_ENDPOINTS.UPDATE_DOCTOR`
- ✅ **Doctors.jsx**: Uses `API_ENDPOINTS.GET_DOCTORS`
- ✅ **AddNewDoctor.jsx**: Uses `API_ENDPOINTS.ADD_DOCTOR`
- ✅ **AddNewAdmin.jsx**: Uses `API_ENDPOINTS.ADD_ADMIN`

## 🏗️ Build Commands

### Root Package.json Scripts
```json
{
  "build": "npm run build:backend && npm run build:frontend && npm run build:dashboard",
  "build:backend": "cd backend && npm install",
  "build:frontend": "cd frontend && npm install && npm run build",
  "build:dashboard": "cd dashboard && npm install && npm run build",
  "start": "cd backend && npm start",
  "dev": "concurrently \"npm run dev:backend\" \"npm run dev:frontend\" \"npm run dev:dashboard\""
}
```

### Backend Package.json Scripts
```json
{
  "start": "node server.js",
  "dev": "nodemon server.js"
}
```

## 🔧 Environment Variables Configuration

### Development Environment
```bash
# backend/.env
PORT=4000
NODE_ENV=development
MONGODB_URI=mongodb://localhost:27017/hospital-management
JWT_SECRET=your-secret-key
JWT_EXPIRE=7d
COOKIE_EXPIRE=7
FRONTEND_URL=http://localhost:5173
DASHBOARD_URL=http://localhost:5174

# frontend/.env
VITE_API_URL=http://localhost:4000
VITE_DASHBOARD_URL=http://localhost:5174

# dashboard/.env
VITE_API_URL=http://localhost:4000
VITE_DASHBOARD_URL=http://localhost:5174
```

### Production Environment (Render)
```yaml
# Backend Service
NODE_ENV: production
MONGODB_URI: # Auto-configured from database
JWT_SECRET: # Auto-generated by Render
JWT_EXPIRE: 7d
COOKIE_EXPIRE: 7
CORS_ORIGIN: https://hospital-frontend.onrender.com

# Frontend Service
VITE_API_URL: https://hospital-backend.onrender.com
VITE_DASHBOARD_URL: https://hospital-dashboard.onrender.com

# Dashboard Service
VITE_API_URL: https://hospital-backend.onrender.com
VITE_DASHBOARD_URL: https://hospital-dashboard.onrender.com
```

## 🚀 Render Deployment Configuration

### render.yaml
```yaml
databases:
  - name: hospital-management-mongodb
    databaseName: hospital-management
    user: hospital-user
    plan: free

services:
  # Backend API Service
  - type: web
    name: hospital-backend
    env: node
    plan: free
    buildCommand: npm run build:backend
    startCommand: cd backend && npm start
    envVars:
      - key: NODE_ENV
        value: production
      - key: MONGODB_URI
        fromDatabase:
          name: hospital-management-mongodb
          property: connectionString
      - key: JWT_SECRET
        generateValue: true
      - key: JWT_EXPIRE
        value: "7d"
      - key: COOKIE_EXPIRE
        value: "7"
      - key: CORS_ORIGIN
        value: https://hospital-frontend.onrender.com
    healthCheckPath: /api/v1/health
    autoDeploy: true
    pullRequestPreviewsEnabled: true

  # Frontend Service
  - type: web
    name: hospital-frontend
    env: static
    plan: free
    buildCommand: npm run build:frontend
    staticPublishPath: ./frontend/dist
    envVars:
      - key: VITE_API_URL
        value: https://hospital-backend.onrender.com
      - key: VITE_DASHBOARD_URL
        value: https://hospital-dashboard.onrender.com
    autoDeploy: true
    pullRequestPreviewsEnabled: true

  # Dashboard Service
  - type: web
    name: hospital-dashboard
    env: static
    plan: free
    buildCommand: npm run build:dashboard
    staticPublishPath: ./dashboard/dist
    envVars:
      - key: VITE_API_URL
        value: https://hospital-backend.onrender.com
      - key: VITE_DASHBOARD_URL
        value: https://hospital-dashboard.onrender.com
    autoDeploy: true
    pullRequestPreviewsEnabled: true
```

## 🔍 Health Check Configuration

### Backend Health Endpoint
```javascript
// backend/app.js
app.get("/api/v1/health", (req, res) => {
  res.status(200).json({
    success: true,
    message: "Server is running",
    timestamp: new Date().toISOString()
  });
});
```

**Health Check URL**: `https://hospital-backend.onrender.com/api/v1/health`

## 🎯 Service URLs After Deployment

- **Backend API**: `https://hospital-backend.onrender.com`
- **Frontend**: `https://hospital-frontend.onrender.com`
- **Dashboard**: `https://hospital-dashboard.onrender.com`
- **Health Check**: `https://hospital-backend.onrender.com/api/v1/health`

## ✅ Connection Verification Checklist

### Backend ✅
- ✅ **Database**: Connected via `MONGODB_URI`
- ✅ **Port**: Uses `process.env.PORT`
- ✅ **CORS**: Configured for frontend and dashboard
- ✅ **Health Check**: `/api/v1/health` endpoint
- ✅ **Environment Variables**: All configured

### Frontend ✅
- ✅ **API Connection**: Uses `VITE_API_URL`
- ✅ **Dashboard Link**: Uses `VITE_DASHBOARD_URL`
- ✅ **All Components**: Updated to use API_ENDPOINTS
- ✅ **No Hardcoded URLs**: All URLs environment-based

### Dashboard ✅
- ✅ **API Connection**: Uses `VITE_API_URL`
- ✅ **Axios Defaults**: Configured with API_BASE_URL
- ✅ **All Components**: Updated to use API_ENDPOINTS
- ✅ **No Hardcoded URLs**: All URLs environment-based

### Render Configuration ✅
- ✅ **Build Commands**: All services configured
- ✅ **Start Commands**: Backend properly configured
- ✅ **Environment Variables**: All services configured
- ✅ **Health Checks**: Backend monitoring enabled
- ✅ **Auto-Deploy**: Enabled for all services
- ✅ **PR Previews**: Enabled for all services

## 🚀 Deployment Flow

1. **Push to GitHub**: All changes committed
2. **Render Blueprint**: Uses render.yaml for automatic setup
3. **Database**: MongoDB automatically provisioned
4. **Backend**: Builds and starts with `cd backend && npm start`
5. **Frontend**: Builds static files, no start command needed
6. **Dashboard**: Builds static files, no start command needed
7. **Environment Variables**: Automatically configured
8. **Health Checks**: Backend monitored for uptime

## 🎉 Summary

✅ **Start Commands**: Properly configured for all services  
✅ **All Connections**: Environment-based, no hardcoded URLs  
✅ **Build System**: Single command builds all services  
✅ **Health Checks**: Backend monitoring enabled  
✅ **Auto-Deploy**: Enabled for all services  
✅ **PR Previews**: Enabled for testing changes  
✅ **Environment Variables**: All properly configured  

Your MERN Stack Hospital Management System is fully connected and ready for deployment! 🏥✨ 